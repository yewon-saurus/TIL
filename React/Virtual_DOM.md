# Virtual DOM

```
리액트가 수많은 개발자들 사이에서
엄청난 사랑을 받는 이유 중 한가지..
바로 빠른 속도!
```

>어떻게 그렇게 빠를 수 있을까 하고 보니?

`가상돔(Virtual DOM)`을 사용해, 효율적으로 페이지를 브라우저에 그려주기 때문..

- DOM

Document Object Model

```
웹페이지 -> Document
웹페이지에서 Element들을 담고있죠
```

브라우저가 이것을 분석해서 페이지를 띄워주는 것인데요

```
DOM
이런 HTML element들을 tree 형태로 표현한 것
```

아.. 알것도 같죠? (또 까먹을 시: 바로 DOM 검색해서 이미지 다시 보고 오기..)

- 실제 DOM에는 브라우저가 화면을 그리는데 필요한 모든 정보가 들어있어, 실제 DOM을 조작하는 작업은 무겁다.

그렇다면 Virtual DOM은 뭐지?

```
실제 DOM과 같은 내용을 담고 있는

복 사 본
```

복사본은 실제 DOM이 아니라, JS 객체형태로 메모리 안에 저장되어 있다.

리액트는 이를 똑똑하게 사용해서.. 실제 DOM을 조작하는데 걸리는 시간을 **획기적으로 줄였다**.

리액트는 STATE가 변경될 때마다 Re-Rendering을 하는데, 이 시점마다 새로운 내용이 담긴 가상돔을 생성한다. 렌더링 이전에 화면의 내용을 담고 있는 (1)가상돔과 업데이트 이후에 발생할 (2)가상돔을 비교해, 어떤 element가 변했는지 확인한다.(Diffing)

Diffing은 효율적인 알고리즘을 사용해 진행되므로, 그 변경사항을 신속히 파악한다.

Diffing을 통해 차이가 발생한 부분만을 실제 DOM에 적용하게 되는 것이다.(Reconciliation)

>이게 어떻게 효율적이라는 걸까요?

그 이유: **Batch Update**

```
변경된 모든 element들을 집단화시켜
이를 한번에 DOM에 적용하는 방식
```

```
만약 리스트 안에서 10개의 항목이 바뀌었다면
실제 DOM을 10번 반복해 수정하는 것이 아니라,
한 번에 집단화시켜 이를 적용
```

DOM 조작에 있어서, 비용이 가장 많이 발생하는 지점은 '브라우저에 화면을 그려주는 작업'. 그만큼 Batch Update는 변경된 element를 별개로 그려주는 것이 아닌, 변경 내용을 한 번에(batch) 받아와 DOM에 적용시켜준다는 점에서 효율을 뽑을 수 있던 것이다.

- React는 실제 DOM의 변경사항을 **빠르게 파악하고 반영하기 위해** 내부적으로 가상돔을 만들어 관리한다.
- 가상돔은.. 그래.. 말하자면.. DOM의 메타데이터, DOM의 요약본인 셈
- JavaScript 객체로 표현된 트리에 CRUD 작업을 수행하는 것이, DOM 노드에 CRUD 작업을 수행하는 것보다 (일반적으로는) 더 빠르다. (대신, 메모리 사용량이 늘어난다는 단점 有)
    - DOM 노드에 CRUD 작업을 수행하는 것은 비싼 작업이다.

## 검색해볼래요 - 키워드 정리

- `shouldComponentUpdate`
- 브라우저의 workflow
    - DOM Tree 생성 - Render Tree 생성 - Layout(reflow) - Painting
- DOM fragment