# 규칙 기반 모델

## 규칙 기반 모델의 개념

- 규칙 기반 모델 Rule Based Model

    - 사람이 하는 판단을 기계에게 맡기는 모델

    - 사람이 일일이 프로그램으로 행동을 구현

        - 규칙을 정해놓고

        - input이 들어오면

        - 해당되는 output을 내놓도록

        - 기계가 스스로 학습하는 게 아니라.. -> rule base

        - 그럼 스스로 학습하는건 뭐라고 해요? -> knowledge base

            - 사람이 학습하는 데 필요한 모든 것들을 알려준다..
        
- 조건 분기

    - 특정 조건을 비교해서 처리할 일을 나누는 것

    - 규칙 기반 에서는 -> 조건 분기 를 이용 -> 규칙을 구현

    - 일반적으로, `if ~ then ~: 만일 ~라면 ~를 한다` 형태

- 규칙 기반 모델을 구현하기 위해서는,

    - 규칙 엔진 & 규칙 집합 필요

        - 규칙 엔진: 규칙에 대한 조건을 평가하고 행동으로 실현하는 것을 담당

        - 규칙 집합: 상황에 대한 경우의 수 모음 -> `모든` 상황에 대한 경우의 수

## 규칙 기반 모델을 이용한 서비스

1. 규칙 기반 챗봇

    - 사용자의 질의 키워드에 대해 -> 규칙 집합(or 데이터베이스)에 -> 미리 정의된 키워드와 매칭되는 것이 있는 지 찾아 답변

    - 순서도 따라서 좁혀가는 식으로..

2. 인공지능 기반 챗봇

    - 머신러닝 or 자연어 처리 등 사용

    - 질의에 대한 답에 스스로 학습 -> 더욱 지능적으로 변해감

    - 정해진 규칙 없음!! -> 스스로 학습하여 답변

3. 혼합형 챗봇

    - 가장 일반적인 유형

    - 규칙 기반 + 인공지능 기반

    - 간단한 질의 -> 규칙 이용

    - 대화가 깊어지고 질의 어려우면 -> 학습한 내용을 기반으로 답변

## 규칙 기반 모델의 장점

1. 자연스러운 지식 표현

    - 규칙 기반 모델은..

        - 'A라는 상황에 B라는 행동을 한다'와 같은 식으로 설명 가능

        - 이런건 `if-then` 으로 자연스럽게 표현하기 쉽죠?

2. 통일된 구조

    - 생성된 규칙은, 통일된 `if-then` 구조를 가짐

3. 지식과 과정의 분리

    - 규칙 기반 모델

        - 규칙 vs 사실 -> 이렇게 분리 되는데,

        - 각각 다른 응용 시스템에 재활용

4. 사용자와의 상호작용

    - 얘도 결국은 상호작용을 하는 거긴 한거죠~

    - 사용자의 입력(질의)에 대한 규칙을 검색 -> 이에 적절한 답변 반환

        - 무조건적인 답변

        - 있어보이게 rule based 된거죠

## 규칙 기반 모델의 한계

1. 규칙 간의 불분명한 관계

    - 개별적인 규칙 -> 상대적으로 간단, 이해 쉬움

    - 많은 규칙 -> 규칙의 논리적인 상호 관계에 확신하기 어렵다..

    - 그리고!

        - 개별적인 규칙이, 전체 전략에 어떻게 기여하는 지 관찰하기 어렵다..

2. 빈번한 규칙 수정

    - 개별적인 규칙 수정이 빈번하게 발생하면

        - 이를 일일히 수정해야 함 -> 번거롭다..

    - 수많은 규칙이 있는 규칙 집합 안에서

        - 수정하고자 하는 규칙만 찾아내기 -> 어렵다..

        - 매번 수동으로 수정 & 유지해야 -> 비용 많이 발생

3. 불가능한 학습

    - 배우는 능력이 없음

    - 이미 만들어진 규칙과 사용자 질의에 따라 정답 출력

    - 질의가 규칙을 벗어나면 -> 수정할 능력 없으므로 -> 오류 발생!

    - 반면, 머신러닝은 정답과 사용자 질의에 의해 규칙이 만들어지니까

        - 컴퓨터 스스로 규칙 수정, 생성 가능

### 전통적 프로그래밍 vs 인공지능 프로그래밍

- 강의자료 p11 table 참고

# 지식 기반 모델과 전문가 시스템

## 지식과 전문가

- 지식 knowledge

    - 어떤 주제 or 분야에 대해 -> 이론적 or 실제로 이해하는 것

    - 현재 알려진 일반적인 사실들의 모음

    - 데이터 -> 정보 -> 지식 -> 지혜

- 전문가 expert

    - 지식을 소유한 사람

## 지식 기반 모델의 개념

- 지식 기반 모델 knowledge based model

    - 특정 분야의 전문 지식 + 문제 해결에 필요한 사실, 규칙

        - 등이 저장된 데이터베이스를 활용하는 것

    - 변경이 있을 때마다 -> 프로그램을 수정해야 하는 불편함
    
        - 이런 불편함을 줄이고자.. -> 지식을 기반으로 조건을 설정하는 데이터 영역이 *분리*되어 있음
    
        - 데이터 영역 + 인터페이스 엔진(실제 데이터를 처리 및 출력)

            - 데이터 영역 -> `지식 베이스` 라고 한다네요

    - 규칙 기반 모델은 수백~수천 개의 규칙이 하나의 집합으로 구성

        - 그 반면, 지식 기반 모델의 규칙은 유사한 기능이 `모듈별`로 분할되어 있음

    - 해당 규칙이 포함된 모듈만 찾으면 -> 규칙 기반 모델보다 수정 편리

## 전문가 시스템 expert system

- 인간이 특정 분야에 대하여, 가지고 있는 전문적인 지식을 정리하고 표현 -> 컴퓨터에 기억시킴

- 이로써, 일반인도 전문지식을 이용할 수 있도록 하는 시스템

### 전문가 시스템의 4가지 조건

1. 문제 영역의 전문지식을 이용하여 추론할 것

2. 전문가로부터 획득된 지식일 것

3. 전문적으로 고도의 현실적 문제를 대상으로 할 것

4. 능력이 전문가와 동등할 것

컷이 높네요..

### 전문가 시스템의 구성 요소와 구조

- 사용자 인터페이스

- 추론 엔진 -> 결론을 추론

- 설명 모듈 -> 어떻게 결론에 도달한 거니?

- 지식획득 모듈

- 지식베이스

    - 규칙 -> `if-then` 그거죠?

    - 사실 -> 전문가나 사용자로부터 획득되거나 규칙으로부터 추론된 사실들

# 추천 시스템

## 추천 시스템의 개념

- 추천 시스템 recommender system

    - 콘텐츠 내용에 기반 or 사람들의 성향에 대한 정보 취득 후

    - 개인화 된 맞춤 콘텐츠를 추천

    - 유튜브, 온라인 쇼핑몰, 뉴스, 금융상품, ...

## 추천 시스템의 유형

1. 협업 기반 추천(필터링)

    - 유사한 성향의 사용자 정보를 기반으로..

    - 유사한 사용자..

    - 유유상종 -> `사용자 기반 user based filtering`

    - `아이템 기반 item based filtering`

        - 이전에 구매했던 item을 기반으로..

        - 그 상품과 유사한 다른 상품 추천

        - 걔들끼리 유사한 지 어떻게 알아요? -> 함께 구매되는 경우의 빈도를 분석하여 측정

    - 이런 것들은 `메모리 기반 memory based filtering`에 해당

        - 메모리 기반 추천의 장점

            - 구현이 간단, 이해 용이
        
        - 단점

            - 평점 정보가 많지 않을 경우, 예측 정확도 낮음

            - 사용자나 아이템이 너무 많을 경우, 계산 오래 걸림 -> 실시간 적용 어려움

    - `모델 기반 model based filtering`

        - 메모리 기반의 추천 방식의 단점을 보완하기 위해 등장!

            - 협업 기반 추천의 단점 1: cold start

                - 어느정도 데이터가 누적되어 있지 않다면 -> 신규 사용자에게는 어떠한 콘텐츠도 추천할 수 없지

                - 콜드 스타트: '새로 시작할 때의 곤란함'
            
            - 협.기.추의 단점 2: 계산 효율성 저하
            
                - 사용자 많을 수록 추천을 위한 계산 시간이 길어지는 문제..

            - 협.기.추의 단점 3: long tail

                - 사용자들은 소수의 인기 콘텐츠에 많은 관심을 보이는 경향

                    - 소수 인기 콘텐츠가 전체 추천 콘텐츠의 상당 비율 차지

                    - 관심이 저조한 항목은 정보가 부족 -> 추천되지 못하는 문제 발생

                    ![Long Tail](/AI/img/LongTail.png)

        - 머신러닝 이용 -> 평점 예측

        - 과거의 사용자 평점 데이터를 이용해 모델을 만들어서 -> 평점 정보가 없더라도 -> 특정 콘텐츠에 대한 사용자의 평점 예측 가능

    - 이런 시스템의 성능 평가를 하고 싶으면?

        - 사용자 평가: 특정한 시점에 -> 사용자 초청 -> 성능 좀 괜찮나요? 점검 해주세요

        - 온라인 평가: 실제 환경에서 활용되고 있는 상황에서 -> 사용자가 보여주는 행위를 보고 성능 평가

        - 오프라인 평가: 과거의 데이터를 이용해 평가

            - 데이터 기반의 평가이므로, 사용자 초청 불필요

2. 콘텐츠 기반 추천(필터링)

    - 개인의 누적된 데이터를 기반으로..

    - 협.기.추의 한계를 극복하기 위해 등장!

    - 콘텐츠에 대한 분석을 기반으로..

    - 필터 버블 filter bubble

        - 인터넷 정보 제공자가 맟춤형 정보를 제공하기 때문에,

        - 이용자는 걸러진 정보만을 접하게 되는 현상

        - 제한적 정보만 취득할 수 있음

![추천 시스템의 한계](/AI/img/%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%98%ED%95%9C%EA%B3%84.png)

## 추천 시스템의 활용 사례

- 아마존

    - 명시적 평점, 암묵적 평점 존재

- 넷플릭스

- 페이스북